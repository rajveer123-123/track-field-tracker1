<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pro Athlete Tracker</title>
    
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/857/857455.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root { --gold: #fbbf24; --bg: #0a0a0a; --card: #171717; --text: #ffffff; }
        body { background-color: var(--bg); color: var(--text); font-family: sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; }
        header { width: 100%; padding: 15px 0; background: #000; border-bottom: 2px solid var(--gold); text-align: center; font-weight: bold; }
        header span { color: var(--gold); }
        .container { width: 95%; max-width: 500px; padding: 15px 0; }
        .card { background: var(--card); border-radius: 15px; padding: 20px; margin-bottom: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        #display { font-size: 3.5rem; font-weight: bold; color: var(--gold); text-align: center; margin-bottom: 15px; font-family: monospace; }
        label { display: block; margin-bottom: 5px; font-size: 0.9rem; color: #888; }
        select, input { width: 100%; padding: 12px; background: #262626; border: 1px solid #404040; border-radius: 10px; color: white; margin-bottom: 15px; box-sizing: border-box; }
        .btn-row { display: flex; gap: 10px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .btn-start { background: #22c55e; color: white; }
        .btn-stop { background: #ef4444; color: white; }
        .btn-record { background: var(--gold); color: black; width: 100%; margin-top: 5px; }
        .chart-container { height: 250px; position: relative; }
    </style>
</head>
<body>

<header>ATHLETE<span>PRO</span> DASHBOARD</header>

<div class="container">
    <div class="card">
        <label>Select Player Name</label>
        <input type="text" id="playerName" placeholder="Enter Player Name" oninput="updateView()">
        
        <label>Select Sport Category</label>
        <select id="sportType" onchange="updateView()">
            <option value="100m Sprint">100m Sprint</option>
            <option value="200m Sprint">200m Sprint</option>
            <option value="Long Jump">Long Jump</option>
            <option value="Javelin">Javelin Throw</option>
            <option value="Shotput">Shotput</option>
        </select>
    </div>

    <div class="card">
        <div id="display">00.00</div>
        <div class="btn-row">
            <button class="btn-start" onclick="startTimer()">START</button>
            <button class="btn-stop" onclick="stopTimer()">STOP</button>
        </div>
        <input type="number" id="manualValue" placeholder="Or Enter Score Manually" style="margin-top: 15px;">
        <button class="btn-record" onclick="recordData()">SAVE DATA</button>
    </div>

    <div class="card">
        <h3 id="chartTitle" style="font-size: 1rem; margin-top: 0; color: var(--gold);">Performance Graph</h3>
        <div class="chart-container">
            <canvas id="playerChart"></canvas>
        </div>
    </div>
</div>

<script>
    let startTime, elapsedTime = 0, timerInterval;
    let myChart;

    // Initialize Chart
    const ctx = document.getElementById('playerChart').getContext('2d');
    function initChart() {
        if (myChart) myChart.destroy();
        myChart = new Chart(ctx, {
            type: 'line',
            data: { labels: [], datasets: [{ label: 'Score', data: [], borderColor: '#fbbf24', tension: 0.4 }] },
            options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: false, grid: { color: '#333' } } } }
        });
    }
    initChart();

    function startTimer() {
        if (window.navigator.vibrate) window.navigator.vibrate(50);
        startTime = Date.now() - elapsedTime;
        timerInterval = setInterval(() => {
            elapsedTime = Date.now() - startTime;
            document.getElementById("display").innerText = (elapsedTime / 1000).toFixed(2);
        }, 10);
    }

    function stopTimer() {
        if (window.navigator.vibrate) window.navigator.vibrate(50);
        clearInterval(timerInterval);
    }

    function recordData() {
        const player = document.getElementById("playerName").value || "Unknown";
        const sport = document.getElementById("sportType").value;
        const manual = document.getElementById("manualValue").value;
        const finalValue = manual ? manual : (elapsedTime / 1000).toFixed(2);
        
        if (finalValue <= 0) return alert("Please record a score!");

        // Save to LocalStorage
        let records = JSON.parse(localStorage.getItem('athleteData')) || [];
        records.push({ player, sport, value: parseFloat(finalValue), time: new Date().toLocaleTimeString() });
        localStorage.setItem('athleteData', JSON.stringify(records));

        alert(`Saved for ${player}: ${finalValue}`);
        updateView();
        
        // Reset
        document.getElementById("manualValue").value = "";
        elapsedTime = 0;
        document.getElementById("display").innerText = "00.00";
    }

    function updateView() {
        const player = document.getElementById("playerName").value || "Unknown";
        const sport = document.getElementById("sportType").value;
        document.getElementById("chartTitle").innerText = `${player}'s ${sport} Progress`;

        let records = JSON.parse(localStorage.getItem('athleteData')) || [];
        
        // Filter data for this specific player AND this specific sport
        let filteredData = records.filter(r => r.player === player && r.sport === sport);

        myChart.data.labels = filteredData.map(r => r.time);
        myChart.data.datasets[0].data = filteredData.map(r => r.value);
        myChart.data.datasets[0].label = `${sport} Records`;
        myChart.update();
    }
</script>

</body>
</html>
